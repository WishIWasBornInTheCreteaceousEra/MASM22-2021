geom_hline(yintercept = HiV,
color = "red") +
theme(axis.title.y=element_blank())+
theme(text = element_text(size = 18))
)
rk2<-ggplot(iris.gathered, aes(x = values, y = v)) +
geom_point(size = 2)  +
facet_wrap(~variable)+
theme(text = element_text(size = 18))
(
rk2+
geom_point(data = Q3c.pred[abs(Q3c.pred$v) > HiV,],
color = "red", size = 3)+
geom_point(data = Q3c.pred[Alcoholic, ],
color = "blue", shape = 24, size = 3) +
geom_hline(yintercept = 1/nrow(PositivePlasma)) +
geom_hline(yintercept = HiV,
color = "red") +
theme(axis.title.y=element_blank()))
rk2<-ggplot(iris.gathered, aes(x = values, y = v)) +
geom_point(size = 2)  +
facet_wrap(~variable)+
theme(text = element_text(size = 18))
(
rk2+
geom_point(data = Q3c.pred[abs(Q3c.pred$v) > HiV,],
color = "red", size = 3)+
geom_point(data = Q3c.pred[Alcoholic, ],
color = "blue", shape = 24, size = 3) +
geom_hline(yintercept = 1/nrow(PositivePlasma)) +
geom_hline(yintercept = HiV,
color = "red") +
theme(axis.title.y=element_blank())
)
(
rk2+
geom_point(data = iris.gathered[abs(iris.gathered$v) > HiV,],
color = "red", size = 3)+
geom_hline(yintercept = 1/nrow(PositivePlasma)) +
geom_hline(yintercept = HiV,
color = "red") +
theme(axis.title.y=element_blank())
)
(
rk2+
geom_point(data = iris.gathered[abs(iris.gathered$v) > HiV,],
color = "red", size = 3)+
geom_point(data = iris.gathered[Alcoholic, ],
color = "blue", shape = 24, size = 3) +
geom_hline(yintercept = 1/nrow(PositivePlasma)) +
geom_hline(yintercept = HiV,
color = "red") +
theme(axis.title.y=element_blank())
)
iris.gathered$variable["alcohol"]
iris.gathered$variable=="alcohol"
iris.gathered$variable["alcohol"]
max(iris.gathered$variable=="alcohol")
max(iris.gathered$val[iris.gathered$variable=="alcohol"])
max(iris.gathered$values[iris.gathered$variable=="alcohol"])
Alcoholic2<-which(iris.gathered$values==max(iris.gathered$values[iris.gathered$variable=="alcohol"]))
Alcoholic2<-which(iris.gathered$values==max(iris.gathered$values[iris.gathered$variable=="alcohol"]))
rk2<-ggplot(iris.gathered, aes(x = values, y = alcohol)) +
geom_point(size = 2)  +
facet_wrap(~variable)+
theme(text = element_text(size = 18))
(
rk2+
geom_point(data = iris.gathered[abs(iris.gathered$v) > HiV,],
color = "red", size = 3)+
geom_point(data = iris.gathered[Alcoholic2, ],
color = "blue", shape = 24, size = 3) +
geom_hline(yintercept = 1/nrow(PositivePlasma)) +
geom_hline(yintercept = HiV,
color = "red") +
theme(axis.title.y=element_blank())
)
rk2<-ggplot(iris.gathered, aes(x = values, y = alcohol)) +
geom_point(size = 2)  +
facet_wrap(~variable)+
theme(text = element_text(size = 18))
(
rk2+
geom_point(data = iris.gathered[abs(iris.gathered$v) > HiV,],
color = "red", size = 3)+
geom_point(data = iris.gathered[Alcoholic2, ],
color = "blue", shape = 24, size = 3) +
geom_hline(yintercept = 1/nrow(PositivePlasma)) +
geom_hline(yintercept = HiV,
color = "red") +
theme(axis.title.y=element_blank())
)
rk2<-ggplot(iris.gathered, aes(x = values, y = alcohol)) +
geom_point(size = 2)  +
facet_wrap(~variable)+
theme(text = element_text(size = 18))
(
rk2+
geom_point(data = iris.gathered[abs(iris.gathered$alcohol) > HiV,],
color = "red", size = 3)+
geom_point(data = iris.gathered[Alcoholic2, ],
color = "blue", shape = 24, size = 3) +
geom_hline(yintercept = 1/nrow(PositivePlasma)) +
geom_hline(yintercept = HiV,
color = "red") +
theme(axis.title.y=element_blank())
)
iris.gathered<-pivot_longer(Q3c.pred[,-c(1,2,3,4,5,6,14,15)], cols = -alcohol, names_to = "variable", values_to = "values")
View(iris.gathered)
View(iris.gathered)
(
rk2+
geom_point(data = iris.gathered[abs(iris.gathered$alcohol) > HiV,],
color = "red", size = 3)+
geom_point(data = iris.gathered[Alcoholic2, ],
color = "blue", shape = 24, size = 3) +
geom_hline(yintercept = 1/nrow(PositivePlasma)) +
geom_hline(yintercept = HiV,
color = "red") +
theme(axis.title.y=element_blank())
)
(
rk2+
geom_point(data = iris.gathered[abs(iris.gathered$alcohol) > HiV,],
color = "red", size = 3)
)
rk2<-ggplot(iris.gathered, aes(x = values, y = alcohol)) +
geom_point(size = 2)  +
facet_wrap(~variable)+
theme(text = element_text(size = 18))
rk2
(
rk2+
geom_point(data = iris.gathered[abs(iris.gathered$alcohol) > HiV,],
color = "red", size = 3)+
geom_point(data = iris.gathered[Alcoholic2, ],
color = "blue", shape = 24, size = 3) +
geom_hline(yintercept = 1/nrow(PositivePlasma)) +
geom_hline(yintercept = HiV,
color = "red")
)
(
rk2<-ggplot(iris.gathered, aes(x = values, y = alcohol)) +
geom_point(size = 2)  +
facet_wrap(~variable)+
geom_point(data = iris.gathered[Alcoholic2, ],
color = "blue", shape = 24, size = 3)+
theme(text = element_text(size = 18))
)
(
rk2<-ggplot(iris.gathered, aes(x = values, y = alcohol)) +
geom_point(size = 2)  +
geom_point(data = iris.gathered[Alcoholic2, ],
color = "blue", shape = 24, size = 3)+
facet_wrap(~variable)+
theme(text = element_text(size = 18))
)
pa1<-ggplot(Q3c.pred, aes(x = vituse, y = alcohol)) +
geom_point(size = 2)+
geom_point(data = Q3c.pred[Alcoholic, ],
color = "blue", shape = 24, size = 3) +
theme(axis.title.y=element_blank())+
labs(x = "Vitamin Usage") +
theme(text = element_text(size = 18))
pa2<-ggplot(Q3c.pred, aes(x = calories, y = alcohol)) +
geom_point(size = 2)  +
geom_point(data = Q3c.pred[Alcoholic, ],
color = "blue", shape = 24, size = 3) +
theme(axis.title.y=element_blank())+
labs(x = "Caloric Intake [Cal/day]") +
theme(text = element_text(size = 18))
pa3<-ggplot(Q3c.pred, aes(x = fat, y = alcohol)) +
geom_point(size = 2)  +
geom_point(data = Q3c.pred[Alcoholic, ],
color = "blue", shape = 24, size = 3) +
theme(axis.title.y=element_blank())+
labs(x = "Fat Intake [mg/day]") +
theme(text = element_text(size = 18))
pa4<-ggplot(Q3c.pred, aes(x = fiber, y = alcohol)) +
geom_point(size = 2)  +
geom_point(data = Q3c.pred[Alcoholic, ],
color = "blue", shape = 24, size = 3) +
theme(axis.title.y=element_blank())+
labs(x = "Dietary Fiber Intake [g/day]") +
theme(text = element_text(size = 18))
pa5<-ggplot(Q3c.pred, aes(x = cholesterol, y = alcohol)) +
geom_point(size = 2)  +
geom_point(data = Q3c.pred[Alcoholic, ],
color = "blue", shape = 24, size = 3) +
theme(axis.title.y=element_blank())+
labs(x = "Cholesterol Intake [mg/day]") +
theme(text = element_text(size = 18))
pa6<-ggplot(Q3c.pred, aes(x = alcohol, y = alcohol)) +
geom_point(size = 2)  +
geom_point(data = Q3c.pred[Alcoholic, ],
color = "blue", shape = 24, size = 3) +
theme(axis.title.y=element_blank())+
labs(x = "Alcohol Intake [drinks/week]") +
theme(text = element_text(size = 18))
pa7<-ggplot(Q3c.pred, aes(x = betadiet, y = alcohol)) +
geom_point(size = 2)  +
geom_point(data = Q3c.pred[Alcoholic, ],
color = "blue", shape = 24, size = 3) +
theme(axis.title.y=element_blank())+
labs(x = "Dietary beta-carotene Intake [\U03BCg/day]") +
theme(text = element_text(size = 18))
PlotsA<-ggarrange(pa1, pa2, pa3, pa4, pa5, pa6, pa7, labels="AUTO")
annotate_figure(PlotsA,
top = text_grob("Alcoholic Intake vs other dietary variables", color = "black", face = "bold", size = 14),
bottom = text_grob("The Blue triangle represents the extremely heavy drinker", color = "black",
hjust = 1, x = 1, face = "italic", size = 10),
left = text_grob("Alcohol Intake [\U03BCg/day]", color = "black", rot = 90),
)
p1<-ggplot(Q3c.pred, aes(x = vituse, y = v)) +
geom_point(size = 2)  +
geom_point(data = Q3c.pred[abs(Q3c.pred$v) > HiV,],
color = "red", size = 3)+
geom_point(data = Q3c.pred[Alcoholic, ],
color = "blue", shape = 24, size = 3) +
geom_hline(yintercept = 1/nrow(PositivePlasma)) +
geom_hline(yintercept = HiV,
color = "red") +
theme(axis.title.y=element_blank())+
labs(x = "Vitamin Usage") +
theme(text = element_text(size = 18))
p2<-ggplot(Q3c.pred, aes(x = calories, y = v)) +
geom_point(size = 2)  +
geom_point(data = Q3c.pred[abs(Q3c.pred$v) > HiV,],
color = "red", size = 3)+
geom_point(data = Q3c.pred[Alcoholic, ],
color = "blue", shape = 24, size = 3) +
geom_hline(yintercept = 1/nrow(PositivePlasma)) +
geom_hline(yintercept = HiV,
color = "red") +
theme(axis.title.y=element_blank())+
labs(x = "Caloric Intake [Cal/day]") +
theme(text = element_text(size = 18))
p3<-ggplot(Q3c.pred, aes(x = fat, y = v)) +
geom_point(size = 2)  +
geom_point(data = Q3c.pred[abs(Q3c.pred$v) > HiV,],
color = "red", size = 3)+
geom_point(data = Q3c.pred[Alcoholic, ],
color = "blue", shape = 24, size = 3) +
geom_hline(yintercept = 1/nrow(PositivePlasma)) +
geom_hline(yintercept = HiV,
color = "red") +
theme(axis.title.y=element_blank())+
labs(x = "Fat Intake [mg/day]") +
theme(text = element_text(size = 18))
p4<-ggplot(Q3c.pred, aes(x = fiber, y = v)) +
geom_point(size = 2)  +
geom_point(data = Q3c.pred[abs(Q3c.pred$v) > HiV,],
color = "red", size = 3)+
geom_point(data = Q3c.pred[Alcoholic, ],
color = "blue", shape = 24, size = 3) +
geom_hline(yintercept = 1/nrow(PositivePlasma)) +
geom_hline(yintercept = HiV,
color = "red") +
theme(axis.title.y=element_blank())+
labs(x = "Dietary Fiber Intake [g/day]") +
theme(text = element_text(size = 18))
p5<-ggplot(Q3c.pred, aes(x = cholesterol, y = v)) +
geom_point(size = 2)  +
geom_point(data = Q3c.pred[abs(Q3c.pred$v) > HiV,],
color = "red", size = 3)+
geom_point(data = Q3c.pred[Alcoholic, ],
color = "blue", shape = 24, size = 3) +
geom_hline(yintercept = 1/nrow(PositivePlasma)) +
geom_hline(yintercept = HiV,
color = "red") +
theme(axis.title.y=element_blank())+
labs(x = "Cholesterol Intake [mg/day]") +
theme(text = element_text(size = 18))
p6<-ggplot(Q3c.pred, aes(x = alcohol, y = v)) +
geom_point(size = 2)  +
geom_point(data = Q3c.pred[abs(Q3c.pred$v) > HiV,],
color = "red", size = 3)+
geom_point(data = Q3c.pred[Alcoholic, ],
color = "blue", shape = 24, size = 3) +
geom_hline(yintercept = 1/nrow(PositivePlasma)) +
geom_hline(yintercept = HiV,
color = "red") +
theme(axis.title.y=element_blank())+
labs(x = "Alcohol Intake [drinks/week]") +
theme(text = element_text(size = 18))
p7<-ggplot(Q3c.pred, aes(x = betadiet, y = v)) +
geom_point(size = 2)  +
geom_point(data = Q3c.pred[abs(Q3c.pred$v) > HiV,],
color = "red", size = 3)+
geom_point(data = Q3c.pred[Alcoholic, ],
color = "blue", shape = 24, size = 3) +
geom_hline(yintercept = 1/nrow(PositivePlasma)) +
geom_hline(yintercept = HiV,
color = "red") +
theme(axis.title.y=element_blank())+
labs(x = "Dietary beta-carotene Intake [\U03BCg/day]") +
theme(text = element_text(size = 18))
Plots<-ggarrange(p1, p2, p3, p4, p5, p6, p7, labels="AUTO")
annotate_figure(Plots,
top = text_grob("Leverage of the dietary variables", color = "black", face = "bold", size = 14),
bottom = text_grob("y = 1/n (black) and 2(p+1)/n (red)", color = "black",
hjust = 1, x = 1, face = "italic", size = 10),
left = text_grob("Leverage", color = "black", rot = 90),
)
annotate_figure(PlotsA,
top = text_grob("Alcoholic Intake vs other dietary variables", color = "black", face = "bold", size = 14),
bottom = text_grob("The Blue triangle represents the extremely heavy drinker", color = "black",
hjust = 1, x = 1, face = "italic", size = 10),
left = text_grob("Alcohol Intake [\U03BCg/day]", color = "black", rot = 90),
)
annotate_figure(Plots,
top = text_grob("Leverage of the dietary variables", color = "black", face = "bold", size = 14),
bottom = text_grob("y = 1/n (black) and 2(p+1)/n (red)", color = "black",
hjust = 1, x = 1, face = "italic", size = 10),
left = text_grob("Leverage", color = "black", rot = 90),
)
PlotsA<-ggarrange(pa1, pa2, pa3, pa4, pa5, pa6, labels="AUTO")
annotate_figure(PlotsA,
top = text_grob("Alcoholic Intake vs other dietary variables", color = "black", face = "bold", size = 14),
bottom = text_grob("The Blue triangle represents the extremely heavy drinker", color = "black",
hjust = 1, x = 1, face = "italic", size = 10),
left = text_grob("Alcohol Intake [\U03BCg/day]", color = "black", rot = 90),
)
pa1<-ggplot(Q3c.pred, aes(x = vituse, y = alcohol)) +
geom_point(size = 2)+
geom_point(data = Q3c.pred[Alcoholic, ],
color = "blue", shape = 24, size = 3) +
theme(axis.title.y=element_blank())+
labs(x = "Vitamin Usage") +
theme(text = element_text(size = 18))
pa2<-ggplot(Q3c.pred, aes(x = calories, y = alcohol)) +
geom_point(size = 2)  +
geom_point(data = Q3c.pred[Alcoholic, ],
color = "blue", shape = 24, size = 3) +
theme(axis.title.y=element_blank())+
labs(x = "Caloric Intake [Cal/day]") +
theme(text = element_text(size = 18))
pa3<-ggplot(Q3c.pred, aes(x = fat, y = alcohol)) +
geom_point(size = 2)  +
geom_point(data = Q3c.pred[Alcoholic, ],
color = "blue", shape = 24, size = 3) +
theme(axis.title.y=element_blank())+
labs(x = "Fat Intake [mg/day]") +
theme(text = element_text(size = 18))
pa4<-ggplot(Q3c.pred, aes(x = fiber, y = alcohol)) +
geom_point(size = 2)  +
geom_point(data = Q3c.pred[Alcoholic, ],
color = "blue", shape = 24, size = 3) +
theme(axis.title.y=element_blank())+
labs(x = "Dietary Fiber Intake [g/day]") +
theme(text = element_text(size = 18))
pa5<-ggplot(Q3c.pred, aes(x = cholesterol, y = alcohol)) +
geom_point(size = 2)  +
geom_point(data = Q3c.pred[Alcoholic, ],
color = "blue", shape = 24, size = 3) +
theme(axis.title.y=element_blank())+
labs(x = "Cholesterol Intake [mg/day]") +
theme(text = element_text(size = 18))
pa6<-ggplot(Q3c.pred, aes(x = betadiet, y = alcohol)) +
geom_point(size = 2)  +
geom_point(data = Q3c.pred[Alcoholic, ],
color = "blue", shape = 24, size = 3) +
theme(axis.title.y=element_blank())+
labs(x = "Dietary beta-carotene Intake [\U03BCg/day]") +
theme(text = element_text(size = 18))
PlotsA<-ggarrange(pa1, pa2, pa3, pa4, pa5, pa6, labels="AUTO")
annotate_figure(PlotsA,
top = text_grob("Alcoholic Intake vs other dietary variables", color = "black", face = "bold", size = 14),
bottom = text_grob("The Blue triangle represents the extremely heavy drinker", color = "black",
hjust = 1, x = 1, face = "italic", size = 10),
left = text_grob("Alcohol Intake [L/week]", color = "black", rot = 90),
)
Plots<-ggarrange(p1, p2, p3, p4, p5, p6, p7, labels="AUTO")
annotate_figure(Plots,
top = text_grob("Leverage of the dietary variables", color = "black", face = "bold", size = 14),
bottom = text_grob("y = 1/n (black) and 2(p+1)/n (red)", color = "black",
hjust = 1, x = 1, face = "italic", size = 10),
left = text_grob("Leverage", color = "black", rot = 90),
)
annotate_figure(Plots,
top = text_grob("Leverage of the dietary variables", color = "black", face = "bold", size = 14),
bottom = text_grob("y = 1/n (black) and 2(p+1)/n (red)", color = "black",
hjust = 1, x = 1, face = "italic", size = 10),
left = text_grob("Leverage", color = "black", rot = 90),
)
annotate_figure(PlotsA,
top = text_grob("Alcoholic Intake vs other dietary variables", color = "black", face = "bold", size = 14),
bottom = text_grob("The Blue triangle represents the extremely heavy drinker", color = "black",
hjust = 1, x = 1, face = "italic", size = 10),
left = text_grob("Alcohol Intake [L/week]", color = "black", rot = 90),
)
#Question d
(
ggplot(Q3c.pred, aes(x = fit, y = r)) +
facet_wrap(~alcohol)+
geom_point(size = 3) +
geom_smooth(color = "red")+
geom_hline(yintercept = c(-2, 0, 2)) +
geom_hline(yintercept = c(-3, 3), linetype = 2) +
geom_point(data = Q3c.pred[abs(Q3c.pred$r) > 3,], color = "red", size = 4) +
xlab("Predicted beta-carotene levels (g)") +
ylab("Studentized residual") +
labs(title = "Studentized residuals vs predicted values Y-hat") +
theme(text = element_text(size = 18))
)
#Question d
(
ggplot(Q3c.pred, aes(x = fit, y = r)) +
geom_point(size = 3) +
geom_smooth(color = "red")+
geom_hline(yintercept = c(-2, 0, 2)) +
geom_hline(yintercept = c(-3, 3), linetype = 2) +
geom_point(data = Q3c.pred[abs(Q3c.pred$r) > 3,], color = "red", size = 4) +
xlab("Predicted beta-carotene levels (g)") +
ylab("Studentized residual") +
labs(title = "Studentized residuals vs predicted values Y-hat") +
theme(text = element_text(size = 18))
)
#Question d
(
ggplot(Q3c.pred, aes(x = fit, y = r)) +
geom_point(size = 3) +
geom_smooth(color = "red")+
geom_point(data = Q3c.pred[Alcoholic, ],
color = "blue", shape = 24, size = 3)+
geom_hline(yintercept = c(-2, 0, 2)) +
geom_hline(yintercept = c(-3, 3), linetype = 2) +
geom_point(data = Q3c.pred[abs(Q3c.pred$r) > 3,], color = "red", size = 4) +
xlab("Predicted beta-carotene levels (g)") +
ylab("Studentized residual") +
labs(title = "Studentized residuals vs predicted values Y-hat") +
theme(text = element_text(size = 18))
)
which(abs(Q3c.pred$r) > 3)
PositivePlasma[which(abs(Q3c.pred$r) > 3)]
PositivePlasma[c(which(abs(Q3c.pred$r) > 3)),]
#Question d
(
ggplot(Q3c.pred, aes(x = fit, y = r)) +
geom_point(size = 3) +
geom_smooth(color = "red")+
geom_point(data = Q3c.pred[Alcoholic, ],
color = "blue", shape = 24, size = 3)+
geom_hline(yintercept = c(-2, 0, 2)) +
geom_hline(yintercept = c(-3, 3), linetype = 2) +
geom_point(data = Q3c.pred[abs(Q3c.pred$r) > 3,], color = "red", size = 4) +
xlab("Predicted \U03B2-carotene plasma levels [ng/ml]") +
ylab("Studentized residual") +
labs(title = "Studentized residuals vs predicted \U03B2-carotene plasma levels") +
theme(text = element_text(size = 18))
)
ggplot(y0.lin,aes(sample = e))+
geom_qq()+
geom_qq_line()
ggplot(y0.lin, aes(x = fit, y = e))+
geom_point()+
geom_hline(yintercept = 0)+
geom_smooth(method = "loess")
ggplot(y0.lin,aes(x = e))+
geom_histogram(bins = 20)
(
ggplot(Q3c.pred,aes(sample = r))+
geom_qq()+
geom_qq_line()
)
(
ggplot(Q3c.pred,aes(x = r))+
geom_histogram(bins = 20)
)
(
ggplot(Q3c.pred,aes(sample = r))+
geom_qq()+
geom_qq_line()+
labs(title="Q-Q plot of dietary model")+
theme(text = element_text(size = 18))
)
(
ggplot(Q3c.pred,aes(x = r))+
labs(title="Distribution of residuals in the dietary model")+
theme(text = element_text(size = 18))+
geom_histogram(bins = 30)
)
(
ggplot(Q3c.pred,aes(x = r))+
labs(title="Distribution of residuals in the dietary model", x="Studentized residual")+
theme(text = element_text(size = 18))+
geom_histogram(bins = 30)
)
#Question d: Clearly,from the plot we can see that the variance increases as we
(
ggplot(Q3c.pred, aes(x = fit, y = r)) +
geom_point(size = 3) +
geom_smooth(color = "red")+
geom_point(data = Q3c.pred[Alcoholic, ],
color = "blue", shape = 24, size = 3)+
geom_hline(yintercept = c(-2, 0, 2)) +
geom_hline(yintercept = c(-3, 3), linetype = 2) +
geom_point(data = Q3c.pred[abs(Q3c.pred$r) > 3,], color = "red", size = 4) +
xlab("Predicted \U03B2-carotene plasma levels [ng/ml]") +
ylab("Studentized residual") +
labs(title = "Studentized residuals vs predicted \U03B2-carotene plasma levels") +
theme(text = element_text(size = 18))
)
annotate_figure(Plots,
top = text_grob("Leverage of the dietary variables", color = "black", face = "bold", size = 14),
bottom = text_grob("y = 1/n (black) and 2(p+1)/n (red)", color = "black",
hjust = 1, x = 1, face = "italic", size = 10),
left = text_grob("Leverage", color = "black", rot = 90),
)
#(Fat, calories) & (Fat, Cholesterol) highly correlated. Potential issue with alcohol and other variables (flat)
ggpairs(contx)
cor(contx)
