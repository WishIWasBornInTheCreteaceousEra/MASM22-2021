source('~/GitHub/MASM22-2021/Project 1/Project-1.r', echo=TRUE)
x0<-data.frame(age = 30)
confint0<-cbind(x0,round(predict(plasma.LogModel, newdata = x0, interval = "confidence"),digits = 12))
predint0<-cbind(x0,round(predict(plasma.LogModel, newdata = x0, interval = "prediction"),digits = 12))
x1<-data.frame(age = 70)
confint1<-cbind(x1,round(predict(plasma.LogModel, newdata = x1, interval = "confidence"),digits = 12))
predint1<-cbind(x1,round(predict(plasma.LogModel, newdata = x1, interval = "prediction"),digits = 12))
x2<-data.frame(age = 31)
confint2<-cbind(x2,round(predict(plasma.LogModel, newdata = x2, interval = "confidence"),digits = 12))
predint2<-cbind(x2,round(predict(plasma.LogModel, newdata = x2, interval = "prediction"),digits = 12))
x3<-data.frame(age = 71)
confint3<-cbind(x3,round(predict(plasma.LogModel, newdata = x3, interval = "confidence"),digits = 12))
predint3<-cbind(x3,round(predict(plasma.LogModel, newdata = x3, interval = "prediction"),digits = 12))
confint0
confint2
4.825951 - 4.818985
#Difference 30, 31;
exp(4.825951) - exp(4.818985)
confint0$fit
exp(confint0$fit) - exp(confint2$fit)
#Difference 70, 71:
exp(confint1$fit) - exp(confint3$fit)
summary(plasma.LogModel)
predint0
source('~/GitHub/MASM22-2021/Project 1/Project-1.r', echo=TRUE)
(
PositivePlasma$sex <- factor(PositivePlasma$sex,
levels = c(1, 2),
labels = c("Male", "Female"))
)
(
PositivePlasma$smokstat <- factor(PositivePlasma$smokstat,
levels = c(1, 2, 3),
labels = c("Never", "Former", "Current"))
)
(
PositivePlasma$bmicat <- factor(PositivePlasma$bmicat,
levels = c(1,2,3,4),
labels = c("Underweight", "Normal", "Overweight", "Obese"))
)
(frequency <- table(PositivePlasma$smokstat,PositivePlasma$bmicat,PositivePlasma$sex))
(smokefreq <- margin.table(frequency,1))
(bmifreq <- margin.table(frequency,2))
(sexfreq <- margin.table(frequency,3))
(frequency <- table(PositivePlasma$smokstat,PositivePlasma$bmicat,PositivePlasma$sex))
(smokefreq <- margin.table(frequency,1))
(bmifreq <- margin.table(frequency,2))
(sexfreq <- margin.table(frequency,3))
(
bmi.model<- lm(log(betaplasma)~bmicat, data=PositivePlasma)
)
summary(bmi.model)
(x0 <- data.frame(
x = c(1,2,3,4),
bmicat = rep(c("Underweight", "Normal", "Overweight", "Obese"),1)))
(y0 <- cbind(
x0,
predict(bmi.model, x0, se.fit = TRUE),
conf = predict(bmi.model, x0, interval = "confidence"),
pred = predict(bmi.model, x0, interval = "prediction"))
)
y0$conf.fit <- y0$pred.fit <- NULL
y0$se.pred <- sqrt(y0$se.fit^2 + y0$residual.scale^2)
y0
(
bmicat.lines <- ggplot(data=PositivePlasma, aes(x=bmicat, y=betaplasma))+
geom_point(aes(color=bmicat, shape=bmicat), size=3)+
xlab("BMI Category") +
ylab("Plasma \U03B2-carotene Levels [ng/ml]")+
geom_segment(aes(x=x-.15, y=fit, xend=x+.15, yend=fit, color=bmicat), y0, size=1.25)+
geom_segment(aes(x=x-.15, y=conf.lwr, xend=x+.15, yend=conf.lwr, color=bmicat), y0, linetype="dotdash", size=1.25)+
geom_segment(aes(x=x-.15, y=conf.upr, xend=x+.15, yend=conf.upr, color=bmicat), y0, linetype="dotdash", size=1.25)+
geom_segment(aes(x=x-.15, y=pred.lwr, xend=x+.15, yend=pred.lwr, color=bmicat), y0, linetype="dashed", size=1.25)+
geom_segment(aes(x=x-.15, y=pred.upr, xend=x+.15, yend=pred.upr, color=bmicat), y0, linetype="dashed", size=1.25)
)
summary(bmi.model)
summary(bmi.model_relevel)
